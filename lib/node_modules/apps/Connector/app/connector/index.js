var async=require("async"),connector=require("./connector"),setup=function(n,t){var o=t.registrationClient,e=connector(n,{pingFrequency:t.config.pingFrequency,pingUrlPath:t.config.pingUrlPath,networkContext:t.networkContext,connectionStatePingFrequency:t.config.connectionStatePingFrequency,maxFailureCount:t.config.maxFailureCount});n.once("start",function(){o.getBoxId(function(n){n?e.startBoxPing(n):(e.start(),o.on("boxIdChanged",function(n){e.startBoxPing(n)}))})}),n.on("stop",function(){e&&e.close()})};module.exports=setup;