var acceptsCheck=require("Middleware/acceptsCheck.js"),_=require("underscore"),ModelDataProvider=require("../dataProviders/modelsDataProvider.js");!function(){"use strict";var e=function(e,r){var n=r.webServer,t=new ModelDataProvider(e,r.databaseManager,r.database,r.registrationClient);n.get("/SAWeb/services/dataFencing/modelList/:languageCode",acceptsCheck("application/vnd.johndeere.sa.DataFencing.modelList.v1+json, application/json"),function(r,n){var i=r.headers["x-user"],a=r.params.languageCode;t.getModels(a,i,function(r,t){return r?(n.send(500,"Internal Server Error"),void e.error("Internal Server Error while getting models list. ",r)):void n.send(200,{modelList:t,timestamp:(new Date).getTime()})})});var i=function(e){var r=e.split(" ");return _.filter(r,function(e){return""!=e})};n.get("/SAWeb/services/PINService/PINSearch",acceptsCheck("application/vnd.johndeere.sa.pin.getPinInfo.v1+json","application/json"),function(r,n){var a=r.headers["x-user"];if(!r.query.queryString)return n.status(400).end(),void e.error("Required String parameter, queryString is not present.");var o=i(r.query.queryString);return _.isEmpty(o)?void n.status(200).json({pinInfo:null}):void t.getPinInfoFromPinPrefixMatch(o,a,function(t,i){return t?(n.status(500).end(),void e.error("Internal Server Error while searching for PIN(s). "+r.query.queryString)):void n.status(200).json({pinInfo:i})})}),r.onReady()};module.exports=e}();