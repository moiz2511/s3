"use strict";var _=require("underscore"),getExistingActivitiesAssociatedWithUpdatedJobs=function(i,t,e,o){var s=_.pluck(e.jobs,"jobId"),n=_.compact(_.pluck(e.jobs,"boxJobId")),c=_.union(s,n);t.collection("Activities").find({jobId:{$in:c}}).toArray(function(i,t){o(i,t)})},getExistingRecordingsAssociatedWithUpdatedJobs=function(i,t,e,o){getExistingActivitiesAssociatedWithUpdatedJobs(i,t,e,function(i,e){if(i)return void o(i);var s=_.filter(e,function(i){return"liveRecording"===i.type}),n=_.chain(s).map(function(i){return _.map(i.recordings,function(i){return i.serverRecordingId})}).flatten(!0).value();t.collection("Recordings").find({id:{$in:n}}).toArray(function(i,t){o(i,t)})})};exports.getExistingActivitiesAssociatedWithUpdatedJobs=getExistingActivitiesAssociatedWithUpdatedJobs,exports.getExistingRecordingsAssociatedWithUpdatedJobs=getExistingRecordingsAssociatedWithUpdatedJobs;