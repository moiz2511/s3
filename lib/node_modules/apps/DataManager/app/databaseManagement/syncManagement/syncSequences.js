"use strict";var _=require("underscore"),Criterion=function(e,t,n){this.stepDescription=e,this.stepName=t,this.stepTest=n},fullSyncSequences={false:["beginPreRegistrationFullSyncSession","createSession","getDataFileUpdatesForSetup","processDataFileUpdates","collectSyncErrors","saveSyncErrors","completeSession","flagAllModelsHasData","clearDataUpdatesCollection","removeSession"],true:["beginSession","createSession","getDataFileUpdates","processDataFileUpdates","collectSyncErrors","endSession","completeSession","flagAllModelsHasData","clearDataUpdatesCollection","clearSyncErrors","removeSession"]},flagAllModelsHasDataStep=new Criterion("Finishing Sync Session","flagAllModelsHasData",function(e){return e.completed||e.failed}),processDataFileUpdatesStep=new Criterion("Processing Data File Updates","processDataFileUpdates",function(e){return e.dataFileUpdatesRetrieved}),processBoxDeletesStep=new Criterion("Finishing Sync Session By Processing Box Deletes.","processBoxDeletes",function(e){return e.copyManagerNotified}),notifyCopyManagerStep=new Criterion("Finishing Sync Session By Notifying Copy Manager.","notifyCopyManager",function(e){return e.completed||e.failed}),getStateChangesStep=new Criterion("Resuming Sync Session By Getting Box State.","getStateChanges",function(e){return!e.sessionChangeIds}),prepareUpdatesStep=new Criterion("Resuming sync session by continuing to prepare updates.","prepareUpdates",function(e){return!e.updatesPrepared}),processUpdatesStep=new Criterion("Resuming sync session by continuing to process updates.","processUpdates",function(){return!0}),fullSyncCriteria={false:[new Criterion("Starting New Pre-Registration Full Sync Session","beginPreRegistrationFullSyncSession",function(e){return!e}),flagAllModelsHasDataStep,processDataFileUpdatesStep,new Criterion("Retrieving Data File Updates For Pre-Registration Full Sync Session","getDataFileUpdatesForSetup",function(){return!0})],true:[new Criterion("Starting New Full Sync Session","beginSession",function(e){return!e}),flagAllModelsHasDataStep,processDataFileUpdatesStep,new Criterion("Retrieving Data File Updates for Full Sync Session","getDataFileUpdates",function(){return!0})]},quickSyncSequences={false:["beginPreRegistrationQuickSyncSession","createSession","getStateChanges","setServerStateForSetup","saveServerState","prepareUpdates","processUpdates","saveSyncErrors","completeSession","notifyCopyManager","removeSyncedStateChanges","clearUpdatesCollection"],true:["beginSession","createSession","getStateChanges","exchangeStates","getSystemUpdate","getReturnFileUpdate","getUsageDataFileUpdate","updateSupportPayloadInfo","saveServerState","prepareUpdates","processUpdates","getSyncErrors","endSession","completeSession","notifyCopyManager","processBoxDeletes","removeSyncedStateChanges","clearSyncErrors","clearUpdatesCollection"]},quickSyncCriteria={false:[new Criterion("Starting New Pre-Registration Quick Sync Session","beginPreRegistrationQuickSyncSession",function(e){return!e}),processBoxDeletesStep,notifyCopyManagerStep,getStateChangesStep,new Criterion("Resuming Pre-Registration Quick Sync Session By Creating Server State for Setup.","setServerStateForSetup",function(e){return!e.serverState}),prepareUpdatesStep,processUpdatesStep],true:[new Criterion("Starting New Quick Sync Session","beginSession",function(e){return!e}),processBoxDeletesStep,notifyCopyManagerStep,getStateChangesStep,new Criterion("Resuming Quick Sync Session By Exchanging States.","exchangeStates",function(e){return!e.serverState}),prepareUpdatesStep,processUpdatesStep]},getFunctions=function(e,t,n){return _.map(t[n],function(t){return{name:t,function:e[t]}})},getFirstStep=function(e,t,n){return _.find(e[n],function(e){return e.stepTest(t)})};exports.fullSyncCriteria=fullSyncCriteria,exports.fullSyncSequences=fullSyncSequences,exports.getFunctions=getFunctions,exports.getFirstStep=getFirstStep,exports.quickSyncCriteria=quickSyncCriteria,exports.quickSyncSequences=quickSyncSequences;