"use strict";var _=require("underscore"),JDLMDataProvider=function(t,o,n){this._app=t,this._dbManager=o,this._db=n,this._documentId="LMInformationDocument"};JDLMDataProvider.prototype.insertJDLMInfo=function(t){var o=this,n={id:o._documentId,localId:o._documentId,lastDownload:(new Date).toUTCString(),lastDifference:0};o._db.collection("LMInformation").insert(n,function(o){t(o)})},JDLMDataProvider.prototype.getJDLMInfo=function(t){var o=this;o._db.collection("LMInformation").findOne({id:o._documentId},{_id:!1},t)},JDLMDataProvider.prototype.updateJDLMInfo=function(t,o){var n=this;n._db.collection("LMInformation").update({id:{$eq:n._documentId}},{$set:t},{multi:!1},function(t){o(t)})},JDLMDataProvider.prototype.resetJDLMInfo=function(t){var o=this;o.getJDLMInfo(function(n,e){if(n||!e)o.insertJDLMInfo(t);else{var i={lastDownload:(new Date).toUTCString(),lastDifference:0};o.updateJDLMInfo(i,t)}})},module.exports=JDLMDataProvider;