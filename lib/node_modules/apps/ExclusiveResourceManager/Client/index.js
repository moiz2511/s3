"use strict";function ResourceClaimError(e,r,s){Error.call(this,e),this.resources=r,this.ownedApplications=s}function ExclusiveResourceClient(e,r){events.EventEmitter.call(this);var s=this;this._channel=e,this._appName=r,e.on(Protocol.releasedResources,function(e){s.emit("releasedResources",e.resources)})}var events=require("events"),util=require("util"),_=require("underscore"),Protocol=require("Protocol");util.inherits(ResourceClaimError,Error),util.inherits(ExclusiveResourceClient,events.EventEmitter),ExclusiveResourceClient.prototype.useResources=function(e,r,s){var o=this;!s&&_.isFunction(r)&&(s=r,r=o._appName),o._channel.request(Protocol.useResources,{resources:e,application:r},function(r){"deny"===r.claimStatus?s(new ResourceClaimError("resource claims denied",e,r.ownedApplications)):s()})},ExclusiveResourceClient.prototype.releaseResources=function(e,r){var s=this;r||(r=s._appName),s._channel.queue(Protocol.releaseResources,{resources:e,application:r})};var create=function(e,r){if(!r)throw new Error("ExclusiveResourceClient requires a valid default application name.");return new ExclusiveResourceClient(e,r)};exports.create=create,exports.ResourceClaimError=ResourceClaimError;