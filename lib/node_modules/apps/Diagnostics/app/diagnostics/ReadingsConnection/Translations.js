!function(){var r=require("underscore"),n=require("FileUtility"),t=require("xml2js"),i=new t.Parser({mergeAttrs:!0}),e=function(t,e){var o={},s=0,a=[];this.loadTranslations=function(o,s){l(),n.getFileBuffer(o,e,function(n,e){return n?(t.error("Failed to load translations file: "+n.message),u(),void s(n)):r.isEmpty(e)?(n=new Error("Empty translations file"),t.error("Empty translations file",n),u(),void s(n)):void i.parseString(e.toString("utf8"),function(r,n){return r?(t.error("Failed to parse through translations file",r),u(),void s(r)):n?n.translations?(t.info("Successfully parsed through translations file: "+o),void d(n,s)):(u(),void s(new Error("Encountered missing object property values while building translations index"))):(r=new Error("No data in translations file"),t.error("Parsing the translations file returned no data",r),u(),void s(r))})})},this.getTranslation=function(r,n){s>0?a.push(function(){n(o[r])}):n(o[r])};var l=function(){++s},u=function(){--s,0===s&&(r.each(a,function(r){r()}),a=[])};this.clearTranslations=function(){o={}};var d=function(n,i){var e=n.translations.string;r.each(e,function(n){return n.resId?void(o[n.resId]=r.first(n.translation)):void t.error("Encountered missing object property values while building translations index")}),u(),i()}};module.exports=function(r,n){return new e(r,n)}}();