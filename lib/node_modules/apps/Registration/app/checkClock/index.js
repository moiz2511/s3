var protocol=require("Protocol"),environment=require("Environment"),validDate=new Date(environment.clockValidDate),isClockValid=function(){var t=new Date;return t>validDate},setup=function(t,e){var o=null,n=isClockValid(),a=function(){isClockValid()?(i(!0,n),n=!0):o=setTimeout(a,1e4)},i=function(e,o){e!==o&&t.broadcast(protocol.clockStateChanged,{state:e,prevState:o})};t.on("start",function(){i(n),n||a()}),t.on("stop",function(){clearTimeout(o)})};module.exports=setup;